# devops-course
Git Repository for Continuous Development and Deployment - DevOps Master's Course at Tampere University

<br>

**ansible** branch holds the implementation of the instructions provided in the *ansible-instructions* PDF file. Please refer to the instructions here [ansible-instructions](./ansible-instructions.pdf).

<br>


## Steps and Procedure

1. Clone the repository.<br><br>

2. Generate ssh keys using the following command  (The output is generated in the *$HOME/.ssh* directory).  

    ```bash
           ssh-keygen -t rsa -b 2048
    ```
3. Copy **id_rsa.pub** file in the ***$HOME/.ssh*** directory to the cloned project directory.<br><br>
4. Build the docker image using the below command.
    ```bash
        docker build -t ansible-spj .
    ```
5. Start one container from the Docker image (Container name - *container-1-spj*).
    ```bash
        docker run -d --name container-1-spj ansible-spj
    ```
6. Get the  IP Address of *container-1-spj* container using the following command.
    ```bash
        docker exec container-1-spj ifconfig
    ```
7. Add the IP address of *container-1-spj* to the ***hosts*** file in the cloned project directory.<br><br>

8. Run the ansible playbook.
    ```bash
       ansible-playbook ansible-spj-playbook.yaml 
    ```
9. Copy the output(01), including the output of "uptime". <br><br>
10. Re-run and get the uptime(02) again for the 2nd time. <br><br>
11. Start the second container from the Docker image (Container name - *container-2-spj*).
    ```bash
      docker run -d --name container-2-spj ansible-spj
    ```
12. Get the IP address of the *container-2-spj* container using following command.
    ```bash
      docker exec container-2-spj ifconfig
    ```
13. Add the IP address of *container-2-spj* to the ***hosts*** file in the cloned project directory and **comment out** the previously added host entry.<br><br>
14. Run the ansible playbook (Same command as above).<br><br>
15. Copy the output(03), including the output of "uptime".<br><br>
16. Re-run and get the uptime(04) again for the 2nd time.<br><br>

## Outputs

  
  ``` 
   O1 -
   
        PLAY [Ensure the target host has the latest version of git version management system] **********************************************************************************************************************************************
        
        TASK [Gathering Facts] *************************************************************************************************************************************************************************************************************
        ok: [172.17.0.2]
        
        TASK [Update Git Version] **********************************************************************************************************************************************************************************************************
        changed: [172.17.0.2]
        
        PLAY [Query the uptime of the target host] *****************************************************************************************************************************************************************************************
        
        TASK [Gathering Facts] *************************************************************************************************************************************************************************************************************
        ok: [172.17.0.2]
        
        TASK [Get Uptime] ******************************************************************************************************************************************************************************************************************
        changed: [172.17.0.2]
        
        PLAY [Display Uptime of the target host] *******************************************************************************************************************************************************************************************
        
        TASK [Gathering Facts] *************************************************************************************************************************************************************************************************************
        ok: [172.17.0.2]
        
        TASK [Display Uptime] **************************************************************************************************************************************************************************************************************
        ok: [172.17.0.2] => {
            "uptime_output.stdout_lines": [
                " 21:37:50 up  1:09,  0 users,  load average: 2.74, 2.21, 2.04"
            ]
        }
        
        PLAY RECAP *************************************************************************************************************************************************************************************************************************
        172.17.0.2                 : ok=6    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0 
  ```
  ```
   O2 - 
   
        PLAY [Ensure the target host has the latest version of git version management system] **********************************************************************************************************************************************
        
        TASK [Gathering Facts] *************************************************************************************************************************************************************************************************************
        ok: [172.17.0.2]
        
        TASK [Update Git Version] **********************************************************************************************************************************************************************************************************
        ok: [172.17.0.2]
        
        PLAY [Query the uptime of the target host] *****************************************************************************************************************************************************************************************
        
        TASK [Gathering Facts] *************************************************************************************************************************************************************************************************************
        ok: [172.17.0.2]
        
        TASK [Get Uptime] ******************************************************************************************************************************************************************************************************************
        changed: [172.17.0.2]
        
        PLAY [Display Uptime of the target host] *******************************************************************************************************************************************************************************************
        
        TASK [Gathering Facts] *************************************************************************************************************************************************************************************************************
        ok: [172.17.0.2]
        
        TASK [Display Uptime] **************************************************************************************************************************************************************************************************************
        ok: [172.17.0.2] => {
            "uptime_output.stdout_lines": [
                " 21:41:13 up  1:12,  0 users,  load average: 2.43, 2.36, 2.14"
            ]
        }
        
        PLAY RECAP *************************************************************************************************************************************************************************************************************************
        172.17.0.2                 : ok=6    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0 
  ```
  ```
   O3 -

        PLAY [Ensure the target host has the latest version of git version management system] **********************************************************************************************************************************************
        
        TASK [Gathering Facts] *************************************************************************************************************************************************************************************************************
        ok: [172.17.0.3]
        
        TASK [Update Git Version] **********************************************************************************************************************************************************************************************************
        changed: [172.17.0.3]
        
        PLAY [Query the uptime of the target host] *****************************************************************************************************************************************************************************************
        
        TASK [Gathering Facts] *************************************************************************************************************************************************************************************************************
        ok: [172.17.0.3]
        
        TASK [Get Uptime] ******************************************************************************************************************************************************************************************************************
        changed: [172.17.0.3]
        
        PLAY [Display Uptime of the target host] *******************************************************************************************************************************************************************************************
        
        TASK [Gathering Facts] *************************************************************************************************************************************************************************************************************
        ok: [172.17.0.3]
        
        TASK [Display Uptime] **************************************************************************************************************************************************************************************************************
        ok: [172.17.0.3] => {
            "uptime_output.stdout_lines": [
                " 21:44:56 up  1:16,  0 users,  load average: 1.72, 1.92, 2.00"
            ]
        }
        
        PLAY RECAP *************************************************************************************************************************************************************************************************************************
        172.17.0.3                 : ok=6    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
  ```
  ```
   O4 -

        PLAY [Ensure the target host has the latest version of git version management system] **********************************************************************************************************************************************
        
        TASK [Gathering Facts] *************************************************************************************************************************************************************************************************************
        ok: [172.17.0.3]
        
        TASK [Update Git Version] **********************************************************************************************************************************************************************************************************
        ok: [172.17.0.3]
        
        PLAY [Query the uptime of the target host] *****************************************************************************************************************************************************************************************
        
        TASK [Gathering Facts] *************************************************************************************************************************************************************************************************************
        ok: [172.17.0.3]
        
        TASK [Get Uptime] ******************************************************************************************************************************************************************************************************************
        changed: [172.17.0.3]
        
        PLAY [Display Uptime of the target host] *******************************************************************************************************************************************************************************************
        
        TASK [Gathering Facts] *************************************************************************************************************************************************************************************************************
        ok: [172.17.0.3]
        
        TASK [Display Uptime] **************************************************************************************************************************************************************************************************************
        ok: [172.17.0.3] => {
            "uptime_output.stdout_lines": [
                " 21:46:22 up  1:18,  0 users,  load average: 2.02, 1.96, 2.00"
            ]
        }
        
        PLAY RECAP *************************************************************************************************************************************************************************************************************************
        172.17.0.3                 : ok=6    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
  ```
## Analyze
   The output of uptime command was displayed as expected.<br><br>
## Comments
- Added ***host_key_checking=false*** to the *ansible.cfg* to avoid host key checking
- Ran into issues when updating Git with the Ansible playbook, so had to modify the Dockerfile to grant sudoers access to the ssluser.